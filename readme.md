Метроконтроль 2.3 - .msi пакет
==============================

Данный проект - .msi пакет для развёртывания в рамках домена продукта АИС Метроконтроль версии 2.3.

Инструменты для сборки .msi пакета
----------------------------------

Для внесения изменений в пакет и повторной сборки пакета потребуются следующие продукты:

- Microsoft Visual Studio 2012 Shell:
  - [Isolated](http://www.microsoft.com/ru-ru/download/details.aspx?id=30670)
  - [Integrated](http://www.microsoft.com/ru-ru/download/details.aspx?id=30663)
- [Windows Installer XML Toolset - WIX](http://wixtoolset.org/)

Установить необходимо все пакеты в указанном порядке. В результате - получае MS Visual Studio 2012 с подготовленными
шаблонами проектов WiX. После этого открываем файл решения `Metrocontrol\Metrocontrol.sln` и собираем решение.

Варианты пакетов
----------------

### Административная точка установки

В папке `Metrocontrol\bin\Admin image\x86\ru-RU` собран проект, подготовленный к роли административной точки установки. В нём отсутствует интерфейс пользователя.

### .msi пакет в виде единого файла

В папке `Metrocontrol\bin\Single .msi file\x86\ru-RU` собран .msi пакет в виде единого файла. В отличии от предыдущего варианта, в данной редакции присутствует интерфейс пользователя, позволяющий изменить и состав продукта, и папку его установки.

Подготовка административной точки установки
-------------------------------------------

При подготовке административной точки установки доступны к изменении нижеописанные свойства.

### ALLUSERS

По умолчанию - "1". При установке "0" регистрация будет осуществлена в реестре пользователя, а не в реестре компьютера.

### DISABLESHORTCUTS

По умолчанию - "No". При установке значения "Yes" при установке не будут опубликованы ярлыки. Данным свойством следует воспользоваться, если Вы планируете запускать приложения АИС Метроконтроль через ярлыки на `.csmdb23` файлы (о данных дополнительных возможностях пакета читайте далее).

### DISABLEDESKTOPSHORTCUTS

По умолчанию - "No". При установке значения "Yes" при установке не будут опубликованы ярлыки на рабочем столе. При `DISABLESHORTCUTS="Yes"` значение данного свойства роли не играет.

### DISABLEMENUSHORTCUTS

По умолчанию - "No". При установке значения "Yes" при установке не будут опубликованы ярлыки в меню. При `DISABLESHORTCUTS="Yes"` значение данного свойства роли не играет.

### DISABLESTARTUPSHORTCUTS

По умолчанию - "Yes". При установке значения "Yes" при установке не будут опубликованы ярлык на АИС Метроконтроль в меню автозагрузки. При `DISABLESHORTCUTS="Yes"` значение данного свойства роли не играет.

### APPLICATIONFOLDER

Путь к папке, в которую будет установлен программный продукт. По умолчанию - `%ProgramFiles(x86)%\РЦН\Метроконтроль\2.3%`. Устанавливать в качестве значения данного свойства требуется только путь по отношению к `%ProgramFiles%`.

### INSTALLLEVEL

По умолчанию - "100". По умолчнию будут установлены только приложения "АИС Метроконтроль" и "Учёт клейм". При установке `INSTALLLEVEL` больше 200 будет установлено и приложение "Метроконтроль - администратор".

### Управление установкой приложений

Для управления установкой приложений при подготовке административной точки установки следует воспользоваться свойством `ADDDEFAULT`, перечислив приложения через запятую. Идентификаторы приложений:

- `csmmain` - собственно "АИС Метроконтроль";
- `markinv` - приложение "Учёт клейм";
- `csmadmin` - приложение "Метроконтроль - администратор".

Например, если при подготовке административной точки установки указано `ADDDEFAULT=csmadmin`, то подготовленная точка установки без дополнительных трансформаций подзволит установить только приложение "Метроконтроль - администратор".

### Примеры

Несколько примеров подготовки административной точки установки:

	msiexec -a Metrcontrol.msi DISABLEDESKTOPSHORTCUTS=Yes ALLUSERS=0 ADDDEFAULT=csmmain

Данная командная строка готовит точку установки с "отключенными" ярлыками рабочего стола, с установкой приложения для пользователя
(а не для компьютера). Из приложений при этом будет установлена только АИС Метроконтроль.

	msiexec -a Metrcontrol.msi DISABLESHORTCUTS=Yes ADDDEFAULT=csmmain,makrinv,csmadmin

Данная командная строка готовит точку установки с "отключенными" ярлыками. Приложения будут установлены все.
